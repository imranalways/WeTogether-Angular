<title>Posts | WT</title>

<app-navbar></app-navbar>
<br>


<!-- <mdb-card>
    <mdb-card-img src="https://mdbootstrap.com/img/Photos/Lightbox/Thumbnail/img%20(97).jpg" alt="Card image cap"></mdb-card-img>
    <mdb-card-body>
  
     
      <mdb-card-title>
        <h4>Card Title</h4>
      </mdb-card-title>
  
      <mdb-card-text> Some quick example text to build on the card title and make up the bulk of the card's
        content.
      </mdb-card-text>
  
      <a href="#" mdbBtn color="primary" mdbWavesEffect>Button</a>
    </mdb-card-body>
  </mdb-card> -->

<br>
<!-- <div class="container">
  <div class="row">
    <div class="col-md-2"></div>
    <div class="col-md-8">

    </div>
    <div class="col-md-2"></div>
  </div>
</div> -->
<!-- <mdb-card>
    <mdb-card-body>
  
      <mdb-card-title> -->
        <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
          <div class="row">
              <div class="col-md-2"></div>
              <div class="col-md-8">
                  <mdb-card id="postmaker">
                      <mdb-card-text>
                          
                          
                          <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <span class="input-group-text" id="basic-addon1"><b>{{Name}}</b></span>
                            </div>
                            <input (click)="postModal.show()" type="text" class="form-control " placeholder="Whats on your mind?" aria-label="Username" aria-describedby="basic-addon1"
                            name="PostBody" #PostBody="ngModel" [(ngModel)]="service.formData.PostBody">
                          </div>

                            <!-- <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="2"
                            name="PostBody" #PostBody="ngModel" [(ngModel)]="service.formData.PostBody"
                             placeholder="What's on your mind?"></textarea>
                             <button  id="register" [disabled]="form.invalid" type="submit" class="btn btn-primary btn-sm">
                              POST
                          </button> -->
                         
                        </mdb-card-text>
                      <!-- <mdb-card-body>
                        <mdb-card-text>
                        </mdb-card-text>
                      </mdb-card-body> -->
                    </mdb-card>
              </div>
              <div class="col-md-2"></div>
          </div>
      </form>
      <br><br>
      <form #form="ngForm">
      <div class="row">
          <div class="col-md-2"></div>
          <div class="col-md-8">
              <div *ngFor="let post of service.list">
                
                <div *ngFor="let like of service.likes">
                <div *ngIf="post.PostId == like.PostId">
                  {{count()}}
                </div>
              </div>
              <div *ngFor="let comment of service.commentList">
                <p *ngIf="post.PostId==comment.PostId">
                  {{commented()}}
                </p>
              </div>
                  <div id="post" *ngIf="checker==true">
      
                      <mdb-card >
                          <mdb-card-body>
      
                            <mdb-card-title>
                             
                                <div class="row">
                                   <div class="col-md-5">
                                      {{getAgoTime(post.PostDate)}}
                                      <label><b><a routerLink="/Profile/{{post.UserId}}"> {{ post.PostBy }}</a> </b></label>
                                      <p id=privacyTxt *ngIf="post.PostPrivacy=='Public'"> <i class="fa fa-globe" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{agoTime}}</p>
                                      <p id=privacyTxt *ngIf="post.PostPrivacy=='Friends'"><i class="fa fa-users" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{agoTime}}</p>
                                      <p id=privacyTxt *ngIf="post.PostPrivacy=='Only Me'"><i class="fa fa-lock" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{agoTime}}</p>
                                      <!-- <p id=privacyTxt > <i class="fa fa-globe" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{service.agoTime}}</p> -->
                                      
                                      
                                   </div>
                                    <div class="col-md-6"></div>
                                    <div class="col-md-1" *ngIf="error != 'hasError'">
                                    

                                      <ul class="nav navbar-nav nav-flex-icons ml-auto">

                                        <!-- Dropdown -->
                                        <li class="nav-item dropdown">
                                          <a class="nav-link waves-effect" id="" data-toggle="dropdown"
                                            aria-haspopup="true" aria-expanded="false">
                                           
                                            <span class="d-none d-md-inline-block" (click)="getPostById(post.PostId)"><h4><i class="fa fa-ellipsis-h" aria-hidden="true"></i></h4></span>
                                          </a>

                                          <div class="dropdown-menu dropdown-menu-left dropdown-primary" aria-labelledby="navbarDropdownMenuLink">
                                            <a *ngIf="post.UserId == userid" class="dropdown-item" (click)="updateModal.show()">
                                              <span >Edit</span>
                                            </a>
                                            <a *ngIf="post.UserId == userid" class="dropdown-item" (click)="deletePost()">
                                              <span>Delete</span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                              <span>Save</span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                              <span>Report</span>
                                            </a>
                                            
                                            <!-- <a class="dropdown-item" href="#">
                                              <span></span>
                                            </a> -->
                                          </div>
                                        </li>
                                        
                                      </ul>

                                  
                                  </div>
                              </div>
                                
                            </mdb-card-title>
      
                            <mdb-card-text>  
                            
                              <div class="form-group">
                                  <p id="pbody">{{ post.PostBody }}</p>
                                  <div class="row">
                                    
                                    <div class="col-md-12">
                                      <a routerLink="/Imageview" target="_blank"><img id="pimg" *ngIf="post.Attachment!=null" [src]="post.Attachment" (click)="getImage(post.Attachment)"></a>

                                    </div>
                                  
                                  </div>
                                   <p></p> <!--line breaks between image and likes comments -->
                                  <div class="row">
                                    <div class="col-md-1" *ngIf="c>0">
                                     
                                        <b><i id="thumbs" class="fa fa-thumbs-up" aria-hidden="true"></i>  {{c}} </b>
                                     
                                    </div>
                                    <div class="col-md-1" *ngIf="comment_count>0">
                                     
                                        <b><i id="comment" class="fa fa-comment-o" aria-hidden="true"></i> {{comment_count}} </b>
                                     
                                    </div>
                                    <div class="col-md-4"></div>
                                  </div>
                                  
                                  
                              </div>
                              <div *ngFor="let like of service.likes">
                                <p *ngIf="post.PostId==like.PostId && like.UserId==userid">
                                  {{liked()}}
                                </p>
                              </div>
                             
                              <hr>
                              <div class="form-group">
                                  <table *ngIf="error != 'hasError'">
                                      <tr id="btnPost">
                                          <td>
                                              <button class="" name="Like" (click)="LikeClicked(post.PostId,post.UserId)"
                                              type="button" id={{txt}} >Like</button>
                                          </td>
                                          <td id="LikeBtn"><a routerLink="/Post-Details/{{post.PostId}}"><button type="button">Comment</button></a></td>
                                          <td id="LikeBtn"><button type="button">Share</button></td>
                                      </tr>
                                  </table>
                              </div>
                            </mdb-card-text>
      
                          </mdb-card-body>
                        </mdb-card>
                        <br>
                  </div>
                
                  {{unliked()}}
                  {{reset()}}
                  {{ckreset()}}
                  {{comment_reset()}}
                 
              </div>
              <!-- <button type="button" (click)="printPdf(form)">Print ALL</button> -->
              <!-- <button mdbBtn color="primary" mdbWavesEffect printTitle="All Posts( )" printSectionId="print-section" ngxPrint>
                  Print
                </button> -->
              <!-- <br><br><br><br> -->
              <!-- <div id="print-section" hidden>
                  <div *ngFor="let post of service.list" id="post">
                    <div class="form-group">
                        <label><b>{{ post.PostBy }}</b></label>
                        <p>{{ post.PostPrivacy }}</p>
                    </div>
                    <div class="form-group">
                        <p>{{ post.PostBody }}</p>
                    </div>
                    <br><hr><br>
                </div>
              </div> -->
          </div>
          <div class="col-md-2"></div>
      </div>
    </form>
      <!-- </mdb-card-title>
  
      <mdb-card-text> 
        
      </mdb-card-text>
  
    </mdb-card-body>
  </mdb-card> -->

  <!-- <div mdbModal #updateModal="mdbModal"  class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myUpdateModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title w-100" id="myModalLabel">Update Post</h4>
        </div>
        <div class="modal-body">
          <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
            
              <label><b>{{Name}} </b> </label>
              <label *ngIf="service.editData.PostPrivacy=='Public'"> <i id="postprivacy" class="fa fa-globe " aria-hidden="true"></i></label>
              <label *ngIf="service.editData.PostPrivacy=='Friends'"><i id="postprivacy" class="fa fa-users" aria-hidden="true"></i></label>
              <label *ngIf="service.editData.PostPrivacy=='Only Me'"><i id="postprivacy" class="fa fa-lock" aria-hidden="true"></i></label>

        
              <select class="form-control form-control-sm " name="PostPrivacy"
                    id="privacy" #PostPrivacy="ngModel" [(ngModel)]="service.editData.PostPrivacy">
                      <option Value="Public">Public</option>
                      <option *ngFor="let PostPrivacy of PrivacyList"   Value="{{PostPrivacy}}">{{PostPrivacy}} </option>
                    </select>
              <div class="md-form form-sm">
                <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="7"
                  name="PostBody" #PostBody="ngModel" [(ngModel)]="service.editData.PostBody"
                  placeholder="What's on your mind?">
               </textarea>
              </div>           
        </form>
          
        </div>
        <div class="modal-footer">
          <button type="button" mdbBtn color="secondary" class="waves-light btn-sm" aria-label="Close" (click)="updateModal.hide()" mdbWavesEffect>Cancle</button>
          <button type="button" mdbBtn color="primary" class="relative waves-light btn-sm" mdbWavesEffect (click)="updatePost()">Update</button>
        </div>
      </div>
    </div>
  </div> -->

  <!-- <div mdbModal #postModal="mdbModal"  class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myPostModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">-->
        <!-- <button type="button" class="close pull-right" aria-label="Close" (click)="postModal.hide()">
          <span aria-hidden="true">Ã—</span>
        </button> -->
        <!-- <h4 class="modal-title w-100" id="myModalLabel">New Post</h4>
      </div>
      <div class="modal-body">
        <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
          
            <label><b>{{Name}} </b> </label>
            <label *ngIf="service.formData.PostPrivacy=='Public'"> <i id="postprivacy" class="fa fa-globe " aria-hidden="true"></i></label>
            <label *ngIf="service.formData.PostPrivacy=='Friends'"><i id="postprivacy" class="fa fa-users" aria-hidden="true"></i></label>
            <label *ngIf="service.formData.PostPrivacy=='Only Me'"><i id="postprivacy" class="fa fa-lock" aria-hidden="true"></i></label>

      
            <select class="form-control form-control-sm " name="PostPrivacy"
            id="privacy" #PostPrivacy="ngModel" [(ngModel)]="service.formData.PostPrivacy">
              <option Value="Public">Public</option>
               <option *ngFor="let PostPrivacy of PrivacyList"   Value="{{PostPrivacy}}">{{PostPrivacy}} </option>
             </select>
       <div class="md-form form-sm">
         
         <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="7"
            name="PostBody" #PostBody="ngModel" [(ngModel)]="service.formData.PostBody"
            placeholder="What's on your mind?">
        </textarea>
          
       </div>       
      </form>
        
      </div>
      <div class="modal-footer">
        <button type="button" mdbBtn color="secondary" class="waves-light btn-sm" aria-label="Close" (click)="postModal.hide()" mdbWavesEffect>Cancle</button>
        <button type="button" mdbBtn color="primary" class="relative waves-light btn-sm" mdbWavesEffect (click)="onSubmit()">Post</button>
      </div>
    </div>
  </div>
</div> -->





<div id="modal" mdbModal #updateModal="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog" aria-labelledby="myUpdateModalLabel"
  aria-hidden="true">
 <div class="row">
   <div class="col-md-3"></div>
   <div class="col-md-6">
     <div class="modal-dialog modal-full-height modal-top" role="document">
       <div class="modal-content">
         <div class="modal-header">
          <button type="button" class="close pull-right" aria-label="Close" (click)="updateModal.hide()">
            <span aria-hidden="true">X</span>
          </button>
           <h4 class="modal-title w-100" id="myModalLabel">Update Post</h4>
         </div>
         <div class="modal-body">
          <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
            
              <label><b>{{Name}} </b> </label>
              <label *ngIf="service.editData.PostPrivacy=='Public'"> <i id="postprivacy" class="fa fa-globe " aria-hidden="true"></i></label>
              <label *ngIf="service.editData.PostPrivacy=='Friends'"><i id="postprivacy" class="fa fa-users" aria-hidden="true"></i></label>
              <label *ngIf="service.editData.PostPrivacy=='Only Me'"><i id="postprivacy" class="fa fa-lock" aria-hidden="true"></i></label>

        
              <select class="form-control form-control-sm " name="PostPrivacy"
                    id="privacy" #PostPrivacy="ngModel" [(ngModel)]="service.editData.PostPrivacy">
                      <option Value="Public">Public</option>
                      <option *ngFor="let PostPrivacy of PrivacyList"   Value="{{PostPrivacy}}">{{PostPrivacy}} </option>
                    </select>
              <div class="md-form form-sm">
                <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="4"
                  name="PostBody" #PostBody="ngModel" [(ngModel)]="service.editData.PostBody"
                  placeholder="What's on your mind?">
               </textarea>
              </div>    
              <div class="row">
                <div class="col-md-2">
                  <input id="file" type="file" class="form-control" (change)="onFileChange($event)"/>
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-7"><img [src]="service.editData.Attachment" *ngIf="service.editData.Attachment" style="height: 200px; width:400px">    
                </div>
                <div class="col-md-2" *ngIf="service.editData.Attachment">
                  <button type="button" class="" aria-label="Close" (click)="CloseImg()">
                    <span aria-hidden="true">x</span>
                  </button>
                </div>
              </div>      
        </form>
          
        </div>
        <div class="modal-footer">
          <!-- <button type="button" mdbBtn color="secondary" class="waves-light btn-sm" aria-label="Close" (click)="updateModal.hide()" mdbWavesEffect>Cancle</button> -->
          <button [disabled]="service.formData.PostBody =='' && !service.editData.Attachment" type="button" mdbBtn color="primary" class="relative waves-light btn-sm" mdbWavesEffect (click)="updatePost()">Update</button>
        </div>
      </div>
    </div>
  </div>
  </div>
   <div class="col-md-3"></div>
 </div> 












<div style="overflow-y: auto" id="modal" mdbModal #postModal="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog" aria-labelledby="myPostModalLabel"
  aria-hidden="true">
 <div class="row">
   <div class="col-md-3"></div>
   <div class="col-md-6">


     <div class="modal-dialog modal-dialog-scrollable  modal-full-height modal-top" role="document">
       <div class="modal-content">
         <div class="modal-header">
          <button type="button" class="close pull-right" aria-label="Close" (click)="postModal.hide()">
            <span aria-hidden="true">X</span>
          </button>
           <h4 class="modal-title w-100" id="myModalLabel">Write a Post</h4>
         </div>
         <div class="modal-body">
           <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
             
               <label><b>{{Name}} </b> </label>
               <label *ngIf="service.formData.PostPrivacy=='Public'"> <i id="postprivacy" class="fa fa-globe " aria-hidden="true"></i></label>
               <label *ngIf="service.formData.PostPrivacy=='Friends'"><i id="postprivacy" class="fa fa-users" aria-hidden="true"></i></label>
               <label *ngIf="service.formData.PostPrivacy=='Only Me'"><i id="postprivacy" class="fa fa-lock" aria-hidden="true"></i></label>
   
         
               <select class="form-control form-control-sm " name="PostPrivacy"
               id="privacy" #PostPrivacy="ngModel" [(ngModel)]="service.formData.PostPrivacy">
                 <option Value="Public">Public</option>
                  <option *ngFor="let PostPrivacy of PrivacyList"   Value="{{PostPrivacy}}">{{PostPrivacy}} </option>
                </select>
          <div class="md-form form-sm">
            
            <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="4"
               name="PostBody" #PostBody="ngModel" [(ngModel)]="service.formData.PostBody"
               placeholder="What's on your mind?">
           </textarea>
          </div>   
          <div class="row">
            <div class="col-md-2">
              <input id="file" type="file" class="form-control" (change)="onFileChange($event)"/>
            </div>
            <div class="col-md-1"></div>
            <div class="col-md-7"><img [src]="service.editData.Attachment" *ngIf="service.editData.Attachment" style="height: 200px; width:400px">    
            </div>
            <div class="col-md-2" *ngIf="service.editData.Attachment">
              <button type="button" class="" aria-label="Close" (click)="CloseImg()">
                <span aria-hidden="true">x</span>
              </button>
            </div>
          </div>
          
         </form>
           
         </div>
         <div class="modal-footer">
           
           <!-- <button type="button" mdbBtn color="secondary" class="waves-light btn-sm" aria-label="Close" (click)="postModal.hide()" mdbWavesEffect>Cancle</button> -->
           <button [disabled]="service.formData.PostBody =='' && !service.editData.Attachment" type="button" mdbBtn color="primary" class="relative waves-light btn-sm" mdbWavesEffect (click)="onSubmit()">Post</button>
        
          </div>
       </div>
     </div>
   </div>
   </div>
   <div class="col-md-3"></div>
 </div> 
