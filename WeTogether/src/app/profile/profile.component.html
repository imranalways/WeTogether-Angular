<title>{{Name}} | WT</title>
<app-navbar></app-navbar>
<br>

<div *ngIf="this.service.formData.Name != ''">
<mdb-card class="text-center" *ngIf="error != 'hasError'">
    <br>
    <div class="row">
        <div class="col-md-4"></div>
        <div class="col-md-4">
          <mdb-card-img class="rounded-circle" src="https://mdbootstrap.com/img/Photos/Lightbox/Thumbnail/img%20(97).jpg" alt="Card image cap"></mdb-card-img>
          <h4><i id="profilePic" class="fa fa-camera" aria-hidden="true" title="Edit Profile Picture"></i></h4>
        </div>
        <div class="col-md-4"></div>
    </div>
    <mdb-card-body>
      <mdb-card-title>
        <h2>{{ service.formData.Name }}</h2>
        <p id="bio">{{ service.formData.Bio }}</p>
      </mdb-card-title>
      <mdb-card-text >
      </mdb-card-text>
      <a id="edit" *ngIf='userid == UrlId' routerLink="/Edit-Profile">EDIT</a>

      <div *ngFor="let req of service.freqList">
       
        <div *ngIf="req.SenderId==userid && req.ReceiverId==UrlId">
          {{hasReceiver()}}
          <button *ngIf='userid != UrlId && req.IsAccepted!=true' class="btn btn-danger btn-sm" style="font-size: 15px;border-radius: 30px;" (click)="sendFriendRequest(UrlId,service.formData.Name)"><i class="fa fa-user-times" aria-hidden="true"></i> cancle Friend Request</button>
          <button *ngIf='userid != UrlId && req.IsAccepted==true' class="btn btn-success btn-sm" style="font-size: 15px;border-radius: 30px;"><i class="fa fa-user-plus" aria-hidden="true"></i> c o n n e c t e d</button>

          <!-- <button *ngIf='userid != UrlId && req.IsAccepted==true' class="btn btn-danger btn-sm" style="font-size: 15px; border-radius: 30px;"><i class="fa fa-times" aria-hidden="true"></i> u n f r i e n d</button> -->

        </div>
        <div *ngIf="req.SenderId==UrlId && req.ReceiverId==userid">
          {{hasReceiver()}}
          <!-- <div class="row">
            <div class="col-md-4"></div>
            <div class="col-md-4"> -->
              <button *ngIf='userid != UrlId && req.IsAccepted==true' class="btn btn-success btn-sm" style="font-size: 15px;border-radius: 30px;"><i class="fa fa-user-plus" aria-hidden="true"></i> c o n n e c t e d</button>

            <!-- </div>
            <div class="col-md-1"></div>
            <div class="col-md-3">
              <button *ngIf='userid != UrlId && req.IsAccepted==true' class="btn btn-danger btn-sm" style="font-size: 15px;border-radius: 30px;"><i class="fa fa-times" aria-hidden="true"></i> u n f r i e n d</button>

            </div>
          </div> -->


          <button *ngIf='userid != UrlId && req.IsAccepted!=true' class="btn btn-success btn-sm" style="border-radius: 30px;" (click)="acceptFriendRequest(UrlId,service.formData.Name,req.RequestId)">A c c e p t</button>
          <button *ngIf='userid != UrlId && req.IsAccepted!=true' class="btn btn-danger btn-sm" style="border-radius: 30px;" (click)="rejectFriendRequest(UrlId,service.formData.Name,req.RequestId)">R e j e c t</button>
        </div>
        <div *ngIf="req.SenderId==UrlId  && req.ReceiverId==userid">
          <div *ngIf="req.IsAccepted==true">
            {{hasReceiver()}}
          </div>
        </div>
      </div>
      
      <div *ngIf="!hasReceiverId">
        <button *ngIf='userid != UrlId' class="btn btn-info btn-sm" style="font-size: 15px;border-radius: 30px;" (click)="sendFriendRequest(UrlId,service.formData.Name)"><i class="fa fa-share-square-o" aria-hidden="true"></i> Send Friend Request</button>
      </div>
      <!-- <i class="fas fa-pencil-alt"></i> -->
      {{hasReceiverReset()}}
    </mdb-card-body>
  </mdb-card>

  <br>

  

<form #form="ngForm" *ngIf="error != 'hasError'">
    <div class="container">
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8">
                <div>
                    <mdb-card class="text-left">
                        <br>
                        <div class="row">
                            <div class="col-md-3"></div>
                            <div class="col-md-7">
                                <p ><i class="fa fa-clock-o" aria-hidden="true">
                                    </i> Joined <b>{{service.formData.JoinDate | date: 'longDate' }}</b>
                                </p>

                                <p ><i class="fa fa-clock-o" aria-hidden="true">
                                </i> DOB <b>{{service.formData.Dob | date: 'longDate' }}</b>
                            </p>

                                <p *ngIf="service.formData.PresentAddress != '' && service.formData.PresentAddress != null">
                                    <i class="fa fa-home" aria-hidden="true"></i> Present Address <b>{{service.formData.PresentAddress}}</b>
                                </p>

                                <p *ngIf="service.formData.College != '' && service.formData.College != null">
                                    <i class="fa fa-university" aria-hidden="true"></i> College <b>{{service.formData.College}}</b>
                                </p>

                                <p *ngIf="service.formData.Graduation != '' && service.formData.Graduation != null">
                                    <i class="fa fa-university" aria-hidden="true"></i> University <b>{{service.formData.Graduation}}</b>
                                </p>

                                <p *ngIf="service.formData.PostGraduation != '' && service.formData.PostGraduation != null">
                                    <i class="fa fa-university" aria-hidden="true"></i> PostGraduation <b>{{service.formData.PostGraduation}}</b>
                                </p>
                                
                                <p *ngIf="service.formData.Relationship != '' && service.formData.Relationship != null">
                                    <i class="fa fa-heartbeat" aria-hidden="true"></i> Relationship <b>{{service.formData.Relationship}}</b>
                                </p>

                                

                               
                                    <p><a routerLink="/Profile-Details/{{UrlId}}" *ngIf='userid != UrlId'><i class="fa fa-ellipsis-h" aria-hidden="true"></i> See more about {{service.formData.Name}} </a></p>

                                    <p><a routerLink="/Profile-Details/{{UrlId}}" *ngIf='userid == UrlId'><i class="fa fa-ellipsis-h" aria-hidden="true"></i> See more about you </a></p>
                                
                                </div>
                                
                            <div class="col-md-2"></div>
                        </div>
                        
                        <mdb-card-body>
                          <mdb-card-title>
                           
                          </mdb-card-title>
                      
                          <mdb-card-text >
                          </mdb-card-text>
        
                        </mdb-card-body>
                      </mdb-card>
                </div>
            </div>
            <div class="col-md-2"></div>
        </div>
    </div>
</form>
<br>

<form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError' && userid==UrlId">
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <mdb-card id="postmaker">
                <mdb-card-text>
                    
                    
                    <div class="input-group mb-3">
                      <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon1"><b>{{Name}}</b></span>
                      </div>
                      <input (click)="postModal.show()" type="text" class="form-control " placeholder="Whats on your mind?" aria-label="Username" aria-describedby="basic-addon1"
                      name="PostBody" #PostBody="ngModel" [(ngModel)]="service.postData.PostBody">
                    </div>

                      <!-- <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="2"
                      name="PostBody" #PostBody="ngModel" [(ngModel)]="service.formData.PostBody"
                       placeholder="What's on your mind?"></textarea>
                       <button  id="register" [disabled]="form.invalid" type="submit" class="btn btn-primary btn-sm">
                        POST
                    </button> -->
                   
                  </mdb-card-text>
                <!-- <mdb-card-body>
                  <mdb-card-text>
                  </mdb-card-text>
                </mdb-card-body> -->
              </mdb-card>
        </div>
        <div class="col-md-2"></div>
    </div>
</form>
<br>

<form #form="ngForm">
      <div class="row">
          <div class="col-md-2"></div>
          <div class="col-md-8">
              <div *ngFor="let post of service.usersPosts">
                
                <div *ngFor="let like of postService.likes">
                <div *ngIf="post.PostId == like.PostId">
                  {{count()}}
                </div>
              </div>
              <div *ngFor="let comment of postService.commentList">
                <p *ngIf="post.PostId==comment.PostId">
                  {{commented()}}
                </p>
              </div>
                  <div id="post" *ngIf="checker==true">
      
                      <mdb-card >
                          <mdb-card-body>
      
                            <mdb-card-title>
                             
                                <div class="row">
                                   <div class="col-md-5">
                                      {{getAgoTime(post.PostDate)}}
                                      <label><b>
                                        <a *ngIf="post.UserId==userid" routerLink="/Profile/me">You</a>
                                        <a *ngIf="post.UserId!=userid" routerLink="/Profile/{{post.UserId}}">{{post.PostBy}}</a>
                                      </b></label>
                                      <p id=privacyTxt *ngIf="post.PostPrivacy=='Public'"> <i class="fa fa-globe" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{agoTime}}</p>
                                      <p id=privacyTxt *ngIf="post.PostPrivacy=='Friends'"><i class="fa fa-users" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{agoTime}}</p>
                                      <p id=privacyTxt *ngIf="post.PostPrivacy=='Only Me'"><i class="fa fa-lock" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{agoTime}}</p>
                                      <!-- <p id=privacyTxt > <i class="fa fa-globe" aria-hidden="true"></i> {{ post.PostPrivacy }} <i id="agoTime" class="fa fa-circle" aria-hidden="true"></i> {{service.agoTime}}</p> -->
                                      
                                      
                                   </div>
                                    <div class="col-md-6"></div>
                                    <div class="col-md-1" *ngIf="error != 'hasError'">
                                    

                                      <ul class="nav navbar-nav nav-flex-icons ml-auto">

                                        <!-- Dropdown -->
                                        <li class="nav-item dropdown">
                                          <a class="nav-link" id="" data-toggle="dropdown"
                                            aria-haspopup="true" aria-expanded="false">
                                           
                                            <span class="d-none d-md-inline-block" (click)="getPostById(post.PostId)"><h4><i class="fa fa-ellipsis-h" aria-hidden="true"></i></h4></span>
                                          </a>

                                          <div class="dropdown-menu dropdown-menu-left dropdown-primary" aria-labelledby="navbarDropdownMenuLink">
                                            <a *ngIf="post.UserId == userid" class="dropdown-item" (click)="updateModal.show()">
                                              <span >Edit</span>
                                            </a>
                                            <a *ngIf="post.UserId == userid" class="dropdown-item" (click)="deletePost()">
                                              <span>Delete</span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                              <span>Save</span>
                                            </a>
                                            <a class="dropdown-item" href="#">
                                              <span>Report</span>
                                            </a>
                                            
                                            <!-- <a class="dropdown-item" href="#">
                                              <span></span>
                                            </a> -->
                                          </div>
                                        </li>
                                        
                                      </ul>

                                  
                                  </div>
                              </div>
                                
                            </mdb-card-title>
      
                            <mdb-card-text>  
                            
                              <div class="form-group">
                                  <p id="pbody">{{ post.PostBody }}</p>
                                  <div class="row">
                                    
                                    <div class="col-md-12">
                                      <a routerLink="/Imageview" target="_blank"><img id="pimg" *ngIf="post.Attachment!=null" [src]="post.Attachment" (click)="getImage(post.Attachment)"></a>

                                    </div>
                                   
                                  </div>
                                  <p></p>
                                  <div class="row">
                                    <div class="col-md-1" *ngIf="c>0">
                                     
                                      <a (mouseenter)="getLikersByPostId(post.PostId)" (click)="likesModal.show()"><b><i id="thumbs" class="fa fa-thumbs-up" aria-hidden="true"></i>  {{c}} </b></a>
                                     
                                    </div>
                                    <div class="col-md-1" *ngIf="comment_count>0">
                                     
                                      <a (mouseenter)="getcommentorsByPostId(post.PostId)" (click)="commentsModal.show()"><b><i id="comment" class="fa fa-comment-o" aria-hidden="true"></i> {{comment_count}} </b></a>
                                     
                                    </div>
                                    <div class="col-md-4"></div>
                                  </div>
                                  
                                  
                              </div>
                              <div *ngFor="let like of postService.likes">
                                <p *ngIf="post.PostId==like.PostId && like.UserId==userid">
                                  {{liked()}}
                                </p>
                              </div>
                             
                              <hr>
                              <div class="form-group">
                                  <table *ngIf="error != 'hasError'">
                                      <tr id="btnPost">
                                          <td>
                                              <button class="" name="Like" (click)="LikeClicked(post.PostId)"
                                              type="button" id={{txt}} >Like</button>
                                          </td>
                                          <td id="LikeBtn"><a routerLink="/Post-Details/{{post.PostId}}"><button type="button">Comment</button></a></td>
                                          <td id="LikeBtn"><button type="button">Share</button></td>
                                      </tr>
                                  </table>
                              </div>
                            </mdb-card-text>
      
                          </mdb-card-body>
                        </mdb-card>
                        
                  </div>
                
                  {{unliked()}}
                  {{reset()}}
                  {{ckreset()}}
                  {{comment_reset()}}
                  <br>
              </div>
              <!-- <button type="button" (click)="printPdf(form)">Print ALL</button> -->
              <!-- <button mdbBtn color="primary" mdbWavesEffect printTitle="All Posts( )" printSectionId="print-section" ngxPrint>
                  Print
                </button> -->
              <!-- <br><br><br><br> -->
              <!-- <div id="print-section" hidden>
                  <div *ngFor="let post of service.list" id="post">
                    <div class="form-group">
                        <label><b>{{ post.PostBy }}</b></label>
                        <p>{{ post.PostPrivacy }}</p>
                    </div>
                    <div class="form-group">
                        <p>{{ post.PostBody }}</p>
                    </div>
                    <br><hr><br>
                </div>
              </div> -->
          </div>
          <div class="col-md-2"></div>
      </div>
    </form>






    <div id="modal" mdbModal #updateModal="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog" aria-labelledby="myUpdateModalLabel"
    aria-hidden="true">
   <div class="row">
     <div class="col-md-3"></div>
     <div class="col-md-6">
       <div class="modal-dialog modal-full-height modal-top" role="document">
         <div class="modal-content">
           <div class="modal-header">
            <button type="button" class="close pull-right" aria-label="Close" (click)="updateModal.hide()">
              <span aria-hidden="true">X</span>
            </button>
             <h4 class="modal-title w-100" id="myModalLabel">Update Post</h4>
           </div>
           <div class="modal-body">
            <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
              
                <label><b>{{Name}} </b> </label>
                <label *ngIf="postService.editData.PostPrivacy=='Public'"> <i id="postprivacy" class="fa fa-globe " aria-hidden="true"></i></label>
                <label *ngIf="postService.editData.PostPrivacy=='Friends'"><i id="postprivacy" class="fa fa-users" aria-hidden="true"></i></label>
                <label *ngIf="postService.editData.PostPrivacy=='Only Me'"><i id="postprivacy" class="fa fa-lock" aria-hidden="true"></i></label>
  
          
                <select class="form-control form-control-sm " name="PostPrivacy"
                      id="privacy" #PostPrivacy="ngModel" [(ngModel)]="postService.editData.PostPrivacy">
                        <option Value="Public">Public</option>
                        <option *ngFor="let PostPrivacy of PrivacyList"   Value="{{PostPrivacy}}">{{PostPrivacy}} </option>
                      </select>
                <div class="md-form form-sm">
                  <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="4"
                    name="PostBody" #PostBody="ngModel" [(ngModel)]="postService.editData.PostBody"
                    placeholder="What's on your mind?">
                 </textarea>
                </div> 
                <div class="row">
                  <div class="col-md-2">
                    <input id="file" type="file" class="form-control" (change)="onFileChange($event)"/>
                  </div>
                  <div class="col-md-1"></div>
                  <div class="col-md-7"><img [src]="postService.editData.Attachment" *ngIf="postService.editData.Attachment" style="height: 200px; width:400px">    
                  </div>
                  <div class="col-md-2" *ngIf="postService.editData.Attachment">
                    <button type="button" class="" aria-label="Close" (click)="CloseImg()">
                      <span aria-hidden="true">x</span>
                    </button>
                  </div>
                </div>          
          </form>
            
          </div>
          <div class="modal-footer">
            <!-- <button type="button" mdbBtn color="secondary" class="waves-light btn-sm" aria-label="Close" (click)="updateModal.hide()" mdbWavesEffect>Cancle</button> -->
            <button [disabled]="postService.editData.PostBody =='' && !postService.editData.Attachment"  type="button" mdbBtn color="primary" class="relative waves-light btn-sm" mdbWavesEffect (click)="updatePost()" (click)="updateModal.hide()">Update</button>
          </div>
        </div>
      </div>
    </div>
    </div>
     <div class="col-md-3"></div>
   </div> 
  
  
  
  
  
  
  
  
  
  
  
  
  <div id="modal" mdbModal #postModal="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog" aria-labelledby="myPostModalLabel"
    aria-hidden="true">
   <div class="row">
     <div class="col-md-3"></div>
     <div class="col-md-6">
  
  
       <div class="modal-dialog modal-dialog-scrollable  modal-full-height modal-top" role="document">
         <div class="modal-content">
           <div class="modal-header">
            <button type="button" class="close pull-right" aria-label="Close" (click)="postModal.hide()">
              <span aria-hidden="true">X</span>
            </button>
             <h4 class="modal-title w-100" id="myModalLabel">Write a Post</h4>
           </div>
           <div class="modal-body">
             <form #formPostSubmit="ngForm" (submit)="onSubmit(formPostSubmit)" *ngIf="error != 'hasError'">
               
                 <label><b>{{Name}} </b> </label>
                 <label *ngIf="service.postData.PostPrivacy=='Public'"> <i id="postprivacy" class="fa fa-globe " aria-hidden="true"></i></label>
                 <label *ngIf="service.postData.PostPrivacy=='Friends'"><i id="postprivacy" class="fa fa-users" aria-hidden="true"></i></label>
                 <label *ngIf="service.postData.PostPrivacy=='Only Me'"><i id="postprivacy" class="fa fa-lock" aria-hidden="true"></i></label>
     
           
                 <select class="form-control form-control-sm " name="PostPrivacy"
                 id="privacy" #PostPrivacy="ngModel" [(ngModel)]="service.postData.PostPrivacy">
                   <option Value="Public">Public</option>
                    <option *ngFor="let PostPrivacy of PrivacyList"   Value="{{PostPrivacy}}">{{PostPrivacy}} </option>
                  </select>
            <div class="md-form form-sm">
              
              <textarea type="text" id="PostBody" class="md-textarea form-control form-control-sm" rows="4"
                 name="PostBody" #PostBody="ngModel" [(ngModel)]="service.postData.PostBody"
                 placeholder="What's on your mind?">
             </textarea>
            </div>   
            <div class="row">
              <div class="col-md-2">
                <input id="file" type="file" class="form-control" (change)="onFileChange($event)"/>
              </div>
              <div class="col-md-1"></div>
              <div class="col-md-7"><img [src]="service.postData.Attachment" *ngIf="service.postData.Attachment" style="height: 200px; width:400px">    
              </div>
              <div class="col-md-2" *ngIf="service.postData.Attachment">
                <button type="button" class="" aria-label="Close" (click)="CloseImg()">
                  <span aria-hidden="true">x</span>
                </button>
              </div>
            </div>
            
           </form>
             
           </div>
           <div class="modal-footer">
             
             <!-- <button type="button" mdbBtn color="secondary" class="waves-light btn-sm" aria-label="Close" (click)="postModal.hide()" mdbWavesEffect>Cancle</button> -->
             <button [disabled]="service.postData.PostBody =='' && !service.postData.Attachment" type="button" mdbBtn color="primary" class="relative waves-light btn-sm" mdbWavesEffect (click)="onSubmit()" (click)="postModal.hide()">Post</button>
          
            </div>
         </div>
       </div>
     </div>
     </div>
     <div class="col-md-3"></div>
   </div> 
  














<br><br>
<!-- <div  class="row" *ngIf="error == 'hasError'">
    <div class="col-md-3"></div>
    <div id="err" class="col-md-6 text-center">
        <h3>
            Oppsss... Something bad happened!
        </h3>
    </div>
    <div class="col-md-3"></div>
</div>
</div>
<br><br> -->
<div  class="row" *ngIf="this.service.formData.Name == ''">
    <div class="col-md-3"></div>
    <div id="err" class="col-md-6 text-center">
        <h3>
            Oppsss... Something bad happened!
        </h3>
    </div>
    <div class="col-md-3"></div>
</div>

<div mdbModal #likesModal="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog" aria-labelledby="myLikesModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close pull-right" aria-label="Close" (click)="likesModal.hide()">
          <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title w-100" id="myModalLabel">Liked People</h4>
      </div>
      <div class="modal-body">
        <div *ngFor="let postliker of postService.postLikes">
          <div class="row">
            <div class="col-md-8">
              <a *ngIf="postliker.UserId==userid" routerLink="/Profile/me" style="text-decoration: none;"><h5>You</h5></a>

              <a *ngIf="postliker.UserId!=userid" routerLink="/Profile/{{postliker.UserId}}" style="text-decoration: none;"><h5>{{postliker.LikedBy}}</h5></a>
             
            </div>
            <div class="col-md-4 pull-right">
              <!-- <button *ngIf="postliker.UserId!=userid" class="btn btn-primary btn-sm pull-right">Add Friend</button> -->
            </div>
          </div>  
        </div>
      </div>
      <!-- <div class="modal-footer">
        <button type="button" mdbBtn color="dark" class="waves-light" aria-label="Close" (click)="likesModal.hide()" mdbWavesEffect>Close</button>
      </div> -->
    </div>
  </div>
</div>

<div mdbModal #commentsModal="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog" aria-labelledby="myCommentsModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close pull-right" aria-label="Close" (click)="commentsModal.hide()">
          <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title w-100" id="myModalLabel">Commented People</h4>
      </div>
      <div class="modal-body">
        <div *ngFor="let postCommentor of postService.comments">
          <div class="row">
            <div class="col-md-8">
              <a *ngIf="postCommentor.C_UserId==userid" routerLink="/Profile/me" style="text-decoration: none;"><h5>You</h5></a>

              <a *ngIf="postCommentor.C_UserId!=userid" routerLink="/Profile/{{postCommentor.C_UserId}}" style="text-decoration: none;"><h5>{{postCommentor.CommentBy}}</h5></a>
             
            </div>
            <div class="col-md-4 pull-right">
              <!-- <button *ngIf="postCommentor.C_UserId!=userid" class="btn btn-primary btn-sm pull-right">Add Friend</button> -->
              
            </div>
          </div>  
        </div>
      </div>
      <!-- <div class="modal-footer">
        <button type="button" mdbBtn color="dark" class="waves-light" aria-label="Close" (click)="likesModal.hide()" mdbWavesEffect>Close</button>
      </div> -->
    </div>
  </div>
</div>


